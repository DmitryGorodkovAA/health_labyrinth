{% extends 'base.html' %}
{% load static %}
{% block content %}

<link rel="stylesheet" href="{% static 'css/style_login_page.css' %}">

<section class="form">
  <div class="container">
    <div class="row align-items-center bg-light discription-div">
      <div class="col-lg-6 d-none d-md-block">
        <h1 class="main-title">Платформа предиктивной аналитики состояния здоровья</h1>
        <p class="lead text-dark mb-5" style="text-align: left;">
          Мы предоставим быструю аналитику и эффективный план, основанный на статистике и исследованиях из надежных источников,
          чтобы обеспечить сохранение вашего здоровья
        </p>
      </div>

      <div class="col-lg-6">
        <div class="form-header d-flex align-items-center mb-4">
          <div class="p-2 ms-auto tab-link active" data-form="loginForm">
            <h1 class="m-0" style="cursor: pointer;">ВХОД</h1>
          </div>
          <div class="vr"></div>
          <div class="p-2 tab-link" data-form="registerForm">
            <h2 class="m-0" style="cursor: pointer;">РЕГИСТРАЦИЯ</h2>
          </div>
        </div>

        <!-- Форма входа -->
        <form id="loginForm" method="post" action="{% url 'login' %}">
          {% csrf_token %}
          <input type="hidden" name="form_type" value="login">

          {% if login_error %}
            <div class="alert alert-danger">{{ login_error }}</div>
          {% endif %}

          <div class="mb-3">
            {{ login_form.email.label_tag }}
            {{ login_form.email }}
            {% for err in login_form.email.errors %}
              <div class="text-danger">{{ err }}</div>
            {% endfor %}
          </div>

          <div class="mb-3">
            {{ login_form.password.label_tag }}
            {{ login_form.password }}
            {% for err in login_form.password.errors %}
              <div class="text-danger">{{ err }}</div>
            {% endfor %}
          </div>

          <div class="mb-3 form-check">
            <input type="checkbox" class="form-check-input" id="remember" name="remember">
            <label class="form-check-label" for="remember">Запомнить меня</label>
          </div>

          <button class="btn btn-primary w-100 cta-button" type="submit">ВОЙТИ</button>
        </form>

        <!-- Форма регистрации -->
        <form id="registerForm" class="needs-validation d-none" method="post" action="{% url 'login' %}" novalidate>
          {% csrf_token %}
          <input type="hidden" name="form_type" value="register">

          {% for field in register_form %}
            <div class="mb-3">
              {{ field.label_tag }}
              {{ field }}
              {% for err in field.errors %}
                <div class="text-danger">{{ err }}</div>
              {% endfor %}
            </div>
          {% endfor %}

          <button type="submit" class="btn btn-success w-100 cta-button">ЗАРЕГИСТРИРОВАТЬСЯ</button>
        </form>

        <p class="mt-3"><a href="#">Забыли пароль?</a></p>
      </div>
    </div>
  </div>
</section>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const tabs = document.querySelectorAll('.tab-link');
  tabs.forEach(tab => {
    tab.addEventListener('click', function() {
      tabs.forEach(t => t.classList.remove('active'));
      this.classList.add('active');
      document.querySelectorAll('form').forEach(f => f.classList.add('d-none'));
      document.getElementById(this.dataset.form).classList.remove('d-none');
    });
  });
});
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
{% endblock %}
